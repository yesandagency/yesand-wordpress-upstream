"use strict";(self.webpackChunkcomplianz_gdpr=self.webpackChunkcomplianz_gdpr||[]).push([[6231],{76231:(t,e,n)=>{n.r(e),n.d(e,{steps:()=>o,useNewOnboardingData:()=>c});var s=n(9588),r=n(81621),i=n(27723);const o={welcome:{title:(0,i.__)("Welcome to Complianz","complianz-gdpr"),prevButton:(0,i.__)("No, Thanks","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),prevButtonGoTo:"newsletter",nextButtonGoTo:"terms"},terms:{title:(0,i.__)("Terms and Conditions","complianz-gdpr"),prevButton:(0,i.__)("Dismiss","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),prevButtonGoTo:"newsletter",nextButtonGoTo:"newsletter"},newsletter:{title:(0,i.__)("Get tips and tricks","complianz-gdpr"),prevButton:(0,i.__)("Skip","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),prevButtonGoTo:"plugins",nextButtonGoTo:"plugins"},plugins:{title:(0,i.__)("Install quickly for free","complianz-gdpr"),prevButton:(0,i.__)("Skip","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),nextButtonSecondary:(0,i.__)("Install","complianz-gdpr"),nextButtonThird:(0,i.__)("Installing ...","complianz-gdpr"),prevButtonGoTo:"thankYou",nextButtonGoTo:"thankYou"},thankYou:{title:(0,i.__)("You’re almost there...","complianz-gdpr"),nextButton:(0,i.__)("Close","complianz-gdpr"),nextButtonGoTo:!1}},l=[{slug:"complianz-terms-conditions",description:(0,i.__)("Missing Terms & Conditions? Generate now","complianz-gdpr"),status:"not-installed",processing:!1},{slug:"burst-statistics",premium:"burst-pro",description:(0,i.__)("Privacy-friendly Analytics? Get started","complianz-gdpr"),status:"not-installed",processing:!1},{slug:"really-simple-ssl",description:(0,i.__)("Really Simple Security? Let’s go","complianz-gdpr"),status:"not-installed",processing:!1}],a=async(t,e,n,r)=>{r((t=>({plugins:t.plugins.map((t=>t.slug===n.slug?{...t,status:"processing"}:t))})));const i={slug:n.slug,plugins:t};try{let t="";if("install_plugin"===e){const r=await s.doAction(e,i);if(!r.request_success)throw new Error("API Error: installing plugin.");const o=r.plugins.find((t=>t.slug===n.slug)).status||"not-installed";if("not-installed"===o)throw new Error("Error installing plugin.");t=o}const o=await s.doAction("activate_plugin",i);if(!o.request_success)throw new Error("API Error: installing plugin.");const l=o.plugins.find((t=>t.slug===n.slug)).status;if("activated"!==l)throw new Error("Error activating plugin.");t=l,r((e=>({plugins:e.plugins.map((e=>e.slug===n.slug?{...e,status:t}:e))})))}catch(t){r({isInstalling:!1}),console.error("Plugin installation error:",t)}},c=(0,r.vt)(((t,e)=>({isModalOpen:!0,isOnboardingComplete:!1,currentStep:"welcome",stepProcessing:!1,isLoading:!1,isContentLoading:!0,setIsContentLoading:e=>t({isContentLoading:e}),nextStepDisabled:!1,prevStepDisabled:!1,wscEmail:"",enableWsc:!1,emailError:"",termsAccepted:!1,wscTerms:"",newsletterAccepted:!1,newsletterEmail:"",newsletterTerms:"",fetchError:!1,fetchErrorMessage:"",fetchDoc:async()=>{t({isLoading:!0,fetchError:!1,fetchErrorMessage:""});const n=e().currentStep;let r="terms"===n?"get_wsc_terms":"get_newsletter_terms";const o=await s.doAction(r);o.request_success||t({fetchError:!0,fetchErrorMessage:(0,i.__)("Something went wrong while downloading the document.","complianz-gdpr")});const l=o.doc;l?"terms"===n?t({wscTerms:l,isLoading:!1}):"newsletter"===n&&t({newsletterTerms:l,isLoading:!1}):t({fetchError:!0,fetchErrorMessage:(0,i.__)("Something went wrong while downloading the document.","complianz-gdpr"),isLoading:!1})},suggestedPlugins:l,plugins:[],fetchPlugins:async()=>{try{const e=await s.doAction("get_recommended_plugins_status",{plugins:l});if(!e.request_success)throw new Error("Error fetching.");const n=e.plugins.map((t=>({...t,checked:"activated"===t.status||!1,toProcess:!1})));t({plugins:n})}catch(t){throw new Error("Api error:",t)}},enablePluginInstallation:!1,isInstalling:!1,setWscEmail:e=>t({wscEmail:e}),setEnableWsc:e=>t({enableWsc:e}),setEmailError:e=>t({emailError:e}),setNewsletterEmail:e=>t({newsletterEmail:e}),setNextStepDisabled:e=>t({nextStepDisabled:e}),setPrevStepDisabled:e=>t({prevStepDisabled:e}),setPlugins:e=>t({plugins:e}),setEnablePluginInstallation:e=>t({enablePluginInstallation:e}),closeModal:async e=>{if(e&&!(await s.doAction("dismiss_wsc_onboarding")).request_success)throw new Error("Error fetching.");const n=new URL(window.location.href);n.searchParams.delete("websitescan"),window.history.pushState({},"",n.href),t({isModalOpen:!1})},goToPrevStep:()=>t((t=>{const e="welcome"===t.currentStep?"newsletter":o[t.currentStep].prevButtonGoTo;return{...t,currentStep:e,stepProcessing:!1}})),goToNextStep:()=>t((async n=>{let r=o[n.currentStep].nextButtonGoTo;t({stepProcessing:!0});try{switch(n.currentStep){case"welcome":0===n.wscEmail.length?(t({enableWsc:!1}),r="newsletter"):t({enableWsc:!0});break;case"terms":let i=e().wscEmail;if(t({termsAccepted:!0,newsletterEmail:i,isLoading:!0}),!(await s.doAction("signup_wsc",{email:i,timestamp:(new Date).getTime(),url:window.location.href})).request_success)throw new Error("Error fetching.");t({isLoading:!1});break;case"newsletter":let o=e().newsletterEmail;if(t({newsletterAccepted:!0,isLoading:!0}),!(await s.doAction("signup_newsletter",{email:o,timestamp:(new Date).getTime(),url:window.location.href})).request_success)throw new Error("Error fetching.");t({isLoading:!1});break;case"plugins":if(!e().enablePluginInstallation)break;const l=e().plugins.filter((t=>t.toProcess));if(l.length<=0)break;const c=e().suggestedPlugins;t({isInstalling:!0});for(const e of l)"not-installed"===e.status?await a(c,"install_plugin",e,t):"installed"===e.status&&await a(c,"activate_plugin",e,t);return void t({isInstalling:!1,stepProcessing:!1,enablePluginInstallation:!1});case"thankYou":t({isOnboardingComplete:!0}),e().closeModal()}t({currentStep:r,stepProcessing:!1})}catch(e){console.error("Error during step transition:",e),t({stepProcessing:!1})}})),isValidEmail:t=>0===t.length||/^[\w-]+(\.[\w-]+)*@[^\s@]+\.[a-zA-Z]{2,}$/.test(t)})))}}]);